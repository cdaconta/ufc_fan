{% extends 'form.html' %}
{% block title %}Edit Fighter{% endblock %}
{% block content %}
  <div class="form-wrapper">
    <form class="form" method="POST" action="/fighter/edit/{{ fighters.id }}">
      <h3 class="form-heading">Edit Fighter - {{fighters.first_name}}</h3>
      
      <div class="form-group">
      
      <div class="form-group">
        <label for="first_name">First Name</label>
        {{ form.first_name(class_ = 'form-control', placeholder='', autofocus = true) }}
      </div>
      <div class="form-group">
        <label for="last_name">Last Name</label>
        {{ form.last_name(class_ = 'form-control',  autofocus = true) }}
      </div>
      <div class="form-group">
        <label for="age">Age</label>
        {{ form.age(class_ = 'form-control',  autofocus = true) }}
      </div>

      <div class="form-group">
        <label for="height">Height</label>
        {{ form.height(class_ = 'form-control', autofocus = true) }}
      </div>
      <div class="form-group">
        <label for="weight">Weight</label>
        {{ form.weight(class_ = 'form-control', autofocus = true) }}
      </div>
      <div class="form-group">
        <label for="arm_reach">Arm Reach</label>
        {{ form.arm_reach(class_ = 'form-control', autofocus = true) }}
      </div>

      <div class="form-group">
        <label for="leg_reach">Leg Reach</label>
        {{ form.leg_reach(class_ = 'form-control', autofocus = true) }}
      </div>
      <div class="form-group">
        <label for="sex">Sex</label>
        {{ form.sex(class_ = 'form-control', autofocus = true) }}
      </div>
      <div class="form-group">
        <label for="win">Win</label>
        {{ form.win(class_ = 'form-control', autofocus = true) }}
      </div>
      <div class="form-group">
        <label for="loss">Loss</label>
        {{ form.loss(class_ = 'form-control', autofocus = true) }}
      </div>
      <div class="form-group">
        <label for="draw">Draw</label>
        {{ form.draw(class_ = 'form-control', autofocus = true) }}
      </div>
      <div class="form-group">
        <label for="division">Division</label>
        <ol>
          <li>men_flyweight</li>
          <li>men_bantamweight</li>
          <li>men_featherweight</li>
          <li>men_lightweight</li>
          <li>men_welterweight</li>
          <li>men_middleweight</li>
          <li>men_lightheavyweight</li>
          <li>men_heavyweight</li>
          <li>women_strawweight</li>
          <li>women_flyweight</li>
          <li>women_bantamweight</li>
          <li>women_featherweight</li>
        </ol>
        {{ form.division(class_ = 'form-control', autofocus = true) }}
      </div>  
      <div class="form-group">
        <label for="rank">Rank</label>
        {{ form.rank(class_ = 'form-control', autofocus = true) }}
      </div>      
      <input type="submit" value="Edit Fighter" class="btn btn-primary btn-lg btn-block">
    </form>
  </div>

<script type="text/javascript">
  function update_vote(name)
  {
    const fighter_number = document.querySelector('#' + name);
    let number_fighter = fighter_number.dataset.fighter;
    
      //alert(number);
    fetch('/event/plus/' + name +'/' + number_fighter,{
        method:"PATCH",
        body: JSON.stringify({ "message":"success" }),
        headers: { "Content-Type":"application/json"}
    })
    .then(
    function(response) {
      if (response.status !== 200) {
        console.log('Looks like there was a problem. Status Code: ' +
          response.status);
        return;
      }

      // Examine the text in the response
       response.json().then(function(data) {
       let fighter_num = data.fighter_votes[0].fighter_number;

       if (fighter_num == 1){
        let total_votes = data.fighter_votes[0].fighter_1_votes;
        let poll_div = document.querySelector('#' + name + '_poll');
        //console.log("This is poll_div " + poll_div);
        poll_div.innerHTML = total_votes;
       } else {
        let total_votes = data.fighter_votes[0].fighter_2_votes; 
        let poll_div = document.querySelector('#' + name + '_poll');  
        poll_div.innerHTML = total_votes;
       }
   //console.log("This is data obj " + data.fighter_votes[0].fighter_number);

      });
    }
  )
  .catch(function(err) {
    console.log('Fetch Error :-S', err);
    });
  }
</script>

{% endblock %}